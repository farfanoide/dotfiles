# use 256 term for pretty colors
# Default termtype. If the rcfile sets $TERM, that overrides this value.
set -g default-terminal "screen-256color"

# use zsh as default shell
# set-option -g default-command /usr/local/bin/zsh --login
set-option -g default-shell /usr/local/bin/zsh

# increase scroll-back history
set -g history-limit 5000

# use vim key bindings
# setw -g mode-keys vi

# enable mouse
set -g mode-mouse on
set -g mouse-select-pane on

# decrease command delay (increases vim responsiveness)
set -sg escape-time 1

# # increase repeat time for repeatable commands
# set -g repeat-time 1000

# # start window index at 1
set -g base-index 1

# # start pane index at 1
setw -g pane-base-index 1

# # highlight window when it has new activity
setw -g monitor-activity on
set -g visual-activity on

# # re-number windows when one is closed
set -g renumber-windows on

# enable pbcopy and pbpaste
# https://github.com/ChrisJohnsen/tmux-MacOSX-pasteboard/blob/master/README.md
# requires brew install reattach-to-user-namespase
set-option -g default-command "reattach-to-user-namespace -l zsh"

###########################
#  Key Bindings
###########################

# tmux prefix
unbind C-b
set -g prefix C-j

# # paste
# unbind C-p
# bind C-p paste-buffer

# window splitting
unbind %
bind \ split-window -h
unbind '"'
bind - split-window -v

# Resize Panes
# http://tangledhelix.com/blog/2012/04/28/iterm2-keymaps-for-tmux/
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Select Panes
unbind-key j
unbind-key k
unbind-key h
unbind-key l

bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r h select-pane -L
bind-key -r l select-pane -R

# Sync Panes
unbind y
bind y setw synchronize-panes

# # create 25% lower split
# unbind t
# bind t split-window -p 25

# # quickly switch panes
# unbind ^J
# bind ^J select-pane -t :.+

# # force a reload of the config file
unbind r
bind r source-file ~/.tmux.conf \; display "Reloaded!"

###########################
# Status Bar
###########################

# enable UTF-8 support
set -g status-utf8 on
set -g utf8
set-window-option -g utf8 on

# set refresh interval for status bar
set -g status-interval 30

# center the status bar
# set -g status-justify left

# show session, window, pane in left status bar
#set -g status-left-length 40
#set -g status-left '#[fg=green]#S#[fg=blue] #I:#P#[default]'

# show hostname, date, time, and battery in right status bar
#set-option -g status-right '#[fg=green]#H#[default] %m/%d/%y %I:%M'
# [fg=red]#(battery discharging)#[default]#(battery charging)'

###########################
# Colors
###########################

# color status bar
#set -g status-bg colour235
#set -g status-fg white

# highlight current window
# set-window-option -g window-status-current-fg black
# set-window-option -g window-status-current-bg green

# set color of active pane
set -g pane-border-fg red
#set -g pane-border-bg black
set -g pane-active-border-fg green
#set -g pane-active-border-bg black


# Ring the bell if any background window rang a bell
set -g bell-action any

# Watch for activity in background windows
setw -g monitor-activity on

# # Keep your finger on ctrl, or don't
bind-key ^D detach-client
bind-key ^C new-window

# Status Bar
set -g status on
set -g status-interval 2
set -g status-fg colour231
set -g status-bg colour234
set -g status-left-length 20
set -g status-left '#[fg=colour16,bg=colour254,bold] #S #[fg=colour254,bg=colour234,nobold]#(eval $POWERLINE_COMMAND tmux left)'
set -g status-right-length 150
set -g status-right "#[fg=colour155]#(pmset -g batt | ~/.bin/battinfo.rb) | #[fg=colour45]%d %b %R #[fg=colour155]| #H "
set -g window-status-format "#[fg=colour244,bg=colour234]#I #[fg=colour240] #[default]#W "
set -g window-status-current-format "#[fg=colour236,bg=colour31]#[fg=colour117,bg=colour31] #I  #[fg=colour231,bold]#W #[fg=colour31,bg=colour234,nobold]"
set-window-option -g window-status-fg colour249
set-window-option -g window-status-activity-attr none
set-window-option -g window-status-bell-attr none
set-window-option -g window-status-activity-fg yellow
set-window-option -g window-status-bell-fg red